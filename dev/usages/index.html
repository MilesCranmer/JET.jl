<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Usages · JET.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">JET.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">README</a></li><li class="is-active"><a class="tocitem" href>Usages</a><ul class="internal"><li><a class="tocitem" href="#toplevel-entries"><span>Top-level Entry Points</span></a></li><li><a class="tocitem" href="#interactive-entries"><span>Interactive Entry Points</span></a></li><li><a class="tocitem" href="#test-integration"><span><code>Test</code> Integration</span></a></li></ul></li><li><a class="tocitem" href="../config/">Configurations</a></li><li><a class="tocitem" href="../optanalysis/">Optimization Analysis</a></li><li><a class="tocitem" href="../internals/">Internals</a></li><li><span class="tocitem">JET Analyzer Framework</span><ul><li><a class="tocitem" href="../generated-plugin-api/">API</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../generated-plugin-examples/dispatch_analysis/">Dispatch Analysis</a></li><li><a class="tocitem" href="../generated-plugin-examples/find_unstable_api/">&quot;Unstable API&quot; Analysis</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Usages</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Usages</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/aviatesk/JET.jl/blob/master/docs/src/usages.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="usages"><a class="docs-heading-anchor" href="#usages">How to Use JET.jl</a><a id="usages-1"></a><a class="docs-heading-anchor-permalink" href="#usages" title="Permalink"></a></h1><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Hold on tight and fasten your seatbelt while JET is analyzing your code for the first time. Once the caches get accumulated, subsequent analysis will run at ✈ speed.</p></div></div><h2 id="toplevel-entries"><a class="docs-heading-anchor" href="#toplevel-entries">Top-level Entry Points</a><a id="toplevel-entries-1"></a><a class="docs-heading-anchor-permalink" href="#toplevel-entries" title="Permalink"></a></h2><p>JET can analyze your &quot;top-level&quot; code. This means you can just give your Julia file or code to JET and get error reports. <a href="#JET.report_file"><code>report_file</code></a>, <a href="#JET.report_and_watch_file"><code>report_and_watch_file</code></a>, <a href="#JET.report_package"><code>report_package</code></a> and <a href="#JET.report_text"><code>report_text</code></a> are the main entry points for that.</p><p>JET will analyze your code &quot;half-statically&quot; – JET will selectively interpret &quot;top-level definitions&quot; (like a function definition) and try to simulate Julia&#39;s top-level code execution, while it tries to avoid executing any other parts of code like function calls but analyzes them by <a href="https://en.wikipedia.org/wiki/Abstract_interpretation">abstract interpretation</a> instead (and this is a part where JET statically analyzes your code). If you&#39;re interested in how JET selects &quot;top-level definitions&quot;, please see <a href="../internals/#JET.virtual_process"><code>JET.virtual_process</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Because JET will actually interpret &quot;top-level definitions&quot; in your code, it certainly <em>runs</em> your code. So we should note that JET can cause some side effects from your code; for example JET will try to expand all the macros used in your code, and so the side effects involved with macro expansions will also happen in JET&#39;s analysis process.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="JET.report_file" href="#JET.report_file"><code>JET.report_file</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">report_file(filename::AbstractString;
            jetconfigs...) -&gt; JETToplevelResult</code></pre><p>Analyzes <code>filename</code> and returns <a href="../internals/#JET.JETToplevelResult"><code>JETToplevelResult</code></a>.</p><p>This function will look for <code>.JET.toml</code> configuration file in the directory of <code>filename</code>, and search <em>up</em> the file tree until any <code>.JET.toml</code> is (or isn&#39;t) found. When found, the configurations specified in the file will be applied. See <a href="../config/#Configuration-File">Configuration File</a> for more details.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>When you want to analyze your package, but any file actually using it isn&#39;t available, the <code>analyze_from_definitions</code> option can be useful (see <a href="../config/#JET.ToplevelConfig"><code>ToplevelConfig</code></a>&#39;s <code>analyze_from_definitions</code> option). <br/>For example, JET can analyze JET itself like below:</p><pre><code class="language-julia-repl hljs"># from the root directory of JET.jl
julia&gt; report_file(&quot;src/JET.jl&quot;;
                   analyze_from_definitions = true)</code></pre><p>See also: <a href="#JET.report_package"><code>report_package</code></a></p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function will enable the <code>toplevel_logger</code> configuration by default with the default logging level. You can still explicitly specify and configure it:</p><pre><code class="language-julia hljs">report_file(args...;
            toplevel_logger = nothing, # suppress toplevel logger
            jetconfigs...) # other configurations</code></pre><p>See <a href="../config/#Logging-Configurations">Logging Configurations</a> for more details.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aviatesk/JET.jl/blob/f811f7d65bf7c64573b2d64d96f5d42fe78bedfd/src/JET.jl#L678-L710">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JET.report_and_watch_file" href="#JET.report_and_watch_file"><code>JET.report_and_watch_file</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">report_and_watch_file(filename::AbstractString;
                      jetconfigs...)</code></pre><p>Watches <code>filename</code> and keeps re-triggering analysis with <a href="#JET.report_file"><code>report_file</code></a> on code update. JET will try to analyze all the <code>include</code>d files reachable from <code>filename</code>, and it will re-trigger analysis if there is code update detected in any of the <code>include</code>d files.</p><p>This function internally uses <a href="https://timholy.github.io/Revise.jl/stable/">Revise.jl</a> to track code updates. Revise also offers possibilities to track changes in files that are not directly analyzed by JET, or even changes in <code>Base</code> files. See <a href="../config/#Watch-Configurations">Watch Configurations</a> for more details.</p><p>See also: <a href="#JET.report_file"><code>report_file</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aviatesk/JET.jl/blob/f811f7d65bf7c64573b2d64d96f5d42fe78bedfd/src/JET.jl#L954-L968">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JET.report_package" href="#JET.report_package"><code>JET.report_package</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">report_package(package::Union{AbstractString,Module};
               jetconfigs...) -&gt; JETToplevelResult</code></pre><p>Analyzes <code>package</code> in the same way as <a href="#JET.report_file"><code>report_file</code></a> with the special default configurations, which are especially tuned for package analysis (see below for details). <code>package</code> can be either a module or a string. In the latter case it must be the name of a package in your current environment.</p><p>This function configures analysis with the following configurations:</p><ul><li><code>analyze_from_definitions = true</code>: allows JET to enter analysis without top-level call sites; this is useful for package analysis since a package itself usually has only definitions but not usages (i.e. call sites)</li><li><code>concretization_patterns = [:(x_ = y_), :(const x_ = y_)]</code>: concretizes every global variable instantiations; concretizations are generally preferred for successful analysis as far as they&#39;re cheap, and global variable instantiations that occur in a package definition are <em>usually</em> very cheap</li></ul><p>See <a href="../config/#JET.ToplevelConfig"><code>ToplevelConfig</code></a> for more details.</p><hr/><pre><code class="nohighlight hljs">report_package([io::IO = stdout];
               jetconfigs...) -&gt; res::ReportResult</code></pre><p>Like above but analyzes the package of the current project.</p><p>See also: <a href="#JET.report_file"><code>report_file</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aviatesk/JET.jl/blob/f811f7d65bf7c64573b2d64d96f5d42fe78bedfd/src/JET.jl#L835-L861">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JET.report_text" href="#JET.report_text"><code>JET.report_text</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">report_text(text::AbstractString,
            filename::AbstractString = &quot;top-level&quot;;
            jetconfigs...) -&gt; JETToplevelResult</code></pre><p>Analyzes <code>text</code> and returns <a href="../internals/#JET.JETToplevelResult"><code>JETToplevelResult</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aviatesk/JET.jl/blob/f811f7d65bf7c64573b2d64d96f5d42fe78bedfd/src/JET.jl#L888-L894">source</a></section></article><h2 id="interactive-entries"><a class="docs-heading-anchor" href="#interactive-entries">Interactive Entry Points</a><a id="interactive-entries-1"></a><a class="docs-heading-anchor-permalink" href="#interactive-entries" title="Permalink"></a></h2><p>There are utilities for checking JET analysis in a running Julia session like REPL or such.</p><article class="docstring"><header><a class="docstring-binding" id="JET.report_call" href="#JET.report_call"><code>JET.report_call</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">report_call(f, types = Tuple{};
            analyzer::Type{&lt;:AbstractAnalyzer} = JETAnalyzer,
            jetconfigs...) -&gt; JETCallResult
report_call(tt::Type{&lt;:Tuple};
            analyzer::Type{&lt;:AbstractAnalyzer} = JETAnalyzer,
            jetconfigs...) -&gt; JETCallResult</code></pre><p>Analyzes the generic function call with the given type signature with <code>analyzer</code>. And finally returns the analysis result as <a href="../internals/#JET.JETCallResult"><code>JETCallResult</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aviatesk/JET.jl/blob/f811f7d65bf7c64573b2d64d96f5d42fe78bedfd/src/JET.jl#L1169-L1179">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JET.@report_call" href="#JET.@report_call"><code>JET.@report_call</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@report_call [jetconfigs...] f(args...)</code></pre><p>Evaluates the arguments to the function call, determines its types, and then calls <a href="#JET.report_call"><code>report_call</code></a> on the resulting expression. As with <code>@code_typed</code> and its family, any of <a href="../config/#JET-configurations">JET configurations</a> can be given as the optional arguments like this:</p><pre><code class="language-julia-repl hljs"># reports `rand(::Type{Bool})` with `aggressive_constant_propagation` configuration turned off
julia&gt; @report_call aggressive_constant_propagation=false rand(Bool)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aviatesk/JET.jl/blob/f811f7d65bf7c64573b2d64d96f5d42fe78bedfd/src/JET.jl#L1153-L1164">source</a></section></article><h2 id="test-integration"><a class="docs-heading-anchor" href="#test-integration"><code>Test</code> Integration</a><a id="test-integration-1"></a><a class="docs-heading-anchor-permalink" href="#test-integration" title="Permalink"></a></h2><p>JET offers entries that are integrated with <a href="https://docs.julialang.org/en/v1/stdlib/Test/"><code>Test</code> standard library&#39;s unit-testing infrastructure</a>. It can be used in your test suite to assert your program is free from errors that JET can detect. Currently, it only supports <a href="#interactive-entries">interactive entries</a>.</p><article class="docstring"><header><a class="docstring-binding" id="JET.@test_call" href="#JET.@test_call"><code>JET.@test_call</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@test_call [jetconfigs...] [broken=false] [skip=false] f(args...)</code></pre><p>Runs <a href="#JET.@report_call"><code>@report_call jetconfigs... f(args...)</code></a> and tests that the generic function call <code>f(args...)</code> is free from problems that <code>@report_call</code> can detect. If executed inside <code>@testset</code>, returns a <code>Pass</code> result if it is, a <code>Fail</code> result if it contains any error points detected, or an <code>Error</code> result if this macro encounters an unexpected error. When the test <code>Fail</code>s, abstract call stack to each problem location will also be printed to <code>stdout</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; @test_call sincos(10)
Test Passed
  Expression: #= none:1 =# JET.@test_call sincos(10)</code></pre><p>As with <a href="#JET.@report_call"><code>@report_call</code></a>, any of <a href="https://aviatesk.github.io/JET.jl/dev/config/">JET configurations</a> or analyzer specific configurations can be given as the optional arguments <code>jetconfigs...</code> like this:</p><pre><code class="language-julia-repl hljs">julia&gt; cond = false

julia&gt; function f(n)
            if cond           # `cond` is untyped, and will be reported by the sound analysis pass, while JET&#39;s default analysis pass will ignore it
                return sin(n)
            else
                return cos(n)
            end
       end;

julia&gt; @test_call f(10)
Test Passed
  Expression: #= none:1 =# JET.@test_call f(10)

julia&gt; @test_call mode=:sound f(10)
JET-test failed at none:1
  Expression: #= none:1 =# JET.@test_call mode = :sound f(10)
  ═════ 1 possible error found ═════
  ┌ @ none:2 goto %4 if not Main.cond
  │ non-boolean (Any) used in boolean context: goto %4 if not Main.cond
  └──────────

ERROR: There was an error during testing</code></pre><p><code>@test_call</code> is fully integrated with <a href="https://docs.julialang.org/en/v1/stdlib/Test/"><code>Test</code> standard library&#39;s unit-testing infrastructure</a>. It means, the result of <code>@test_call</code> will be included in the final <code>@testset</code> summary, it supports <code>skip</code> and <code>broken</code> annotations as like <code>@test</code> and its family:</p><pre><code class="language-julia-repl hljs">julia&gt; using JET, Test

julia&gt; f(ref) = isa(ref[], Number) ? sin(ref[]) : nothing;      # Julia can&#39;t propagate the type constraint `ref[]::Number` to `sin(ref[])`, JET will report `NoMethodError`

julia&gt; g(ref) = (x = ref[]; isa(x, Number) ? sin(x) : nothing); # we can make it type-stable if we extract `ref[]` into a local variable `x`

julia&gt; @testset &quot;check errors&quot; begin
           ref = Ref{Union{Nothing,Int}}(0)
           @test_call f(ref)             # fail
           @test_call g(ref)             # fail
           @test_call broken=true f(ref) # annotated as broken, thus still &quot;pass&quot;
       end
check errors: JET-test failed at none:3
  Expression: #= none:3 =# JET.@test_call f(ref)
  ═════ 1 possible error found ═════
  ┌ @ none:1 Main.sin(Base.getindex(ref))
  │ for 1 of union split cases, no matching method found for call signatures (Tuple{typeof(sin), Nothing})): Main.sin(Base.getindex(ref::Base.RefValue{Union{Nothing, Int64}})::Union{Nothing, Int64})
  └──────────

Test Summary: | Pass  Fail  Broken  Total
check errors  |    1     1       1      3
ERROR: Some tests did not pass: 1 passed, 1 failed, 0 errored, 1 broken.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aviatesk/JET.jl/blob/f811f7d65bf7c64573b2d64d96f5d42fe78bedfd/src/JET.jl#L1209-L1280">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JET.test_call" href="#JET.test_call"><code>JET.test_call</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">test_call(f, types = Tuple{}; broken::Bool = false, skip::Bool = false, jetconfigs...)
test_call(tt::Type{&lt;:Tuple}; broken::Bool = false, skip::Bool = false, jetconfigs...)</code></pre><p>Runs <a href="#JET.report_call"><code>report_call(f, types; jetconfigs...</code></a> and tests that the generic function call <code>f(args...)</code> is free from problems that <code>report_call</code> can detect. Except that it takes a type signature rather than a call expression, this function works in the same way as <a href="#JET.@test_call"><code>@test_call</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aviatesk/JET.jl/blob/f811f7d65bf7c64573b2d64d96f5d42fe78bedfd/src/JET.jl#L1359-L1367">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« README</a><a class="docs-footer-nextpage" href="../config/">Configurations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.6 on <span class="colophon-date" title="Wednesday 8 September 2021 16:33">Wednesday 8 September 2021</span>. Using Julia version 1.8.0-DEV.484.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
